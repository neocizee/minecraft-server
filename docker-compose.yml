version: '3.8'
services:
  # ... (Servicio minecraft_server sin cambios) ...
  
  # ----------------------------------------------------
  # SERVICIO 2: PLAYIT.GG TUNNEL (BUILD LOCAL ESTABLE)
  # ----------------------------------------------------
  playit_agent:
      image: playit-agent-build:latest # Nombre de la imagen que se creará
      container_name: playit_minecraft_tunnel
      restart: unless-stopped
      
      # CRÍTICO: Usamos el build local que ahora es estable
      build:
        context: .
        dockerfile: playit.dockerfile # Usa el nuevo Dockerfile estable
      
      # Esenciales para obtener el código de claim
      stdin_open: true
      tty: true
  
      networks:
        - minecraft_tunnel_network
        
      # Volumen para persistir la configuración
      volumes:
        # Nota: El agente PlayIt.gg usa ~/.playit (que se mapea a /root/.playit en Alpine)
        - playit_config_data:/root/.playit 

# Definición de Volúmenes y Redes (Al final del archivo)
volumes:
  # ... (Volumen de minecraft_data) ...
  playit_config_data:
    name: playit_config
    driver: local

networks:
  # ... (Redes sin cambios) ...
