version: '3.8'
services:
  minecraft_server:
    # Build la imagen
    build: 
      context: . 
      # CRÍTICO: Eliminar la línea 'dockerfile: Dockerfile' si el archivo es 'dockerfile'
      args: 
        SERVER_ENV: ${SERVER_ENV} 
        
    container_name: ${CONTAINER_NAME}
    restart: unless-stopped

    # Límites de recursos...
    
    # Persistencia de Datos
    volumes:
      - minecraft_data:/server 
    
    # Variables de Entorno...

    expose:
      - "25565"

    # Conectar a la red de Cloudflare Tunnel
    networks:
      - default 
      - cloudflare_tunnel_network 

# Definición de Volúmenes (CRÍTICO para el aislamiento)
volumes:
  minecraft_data: 
    name: ${WORLD_VOLUME_NAME}
    driver: local

# Redes
networks:
  default:
    driver: bridge
  cloudflare_tunnel_network:
    external: true
    name: YOUR_CLOUDFLARE_TUNNEL_NETWORK_NAME