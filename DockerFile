# Usa la imagen base oficial de Java (Java 17 es común para Minecraft 1.18+)
FROM eclipse-temurin:17-jre-alpine

# Argumentos para la versión de Minecraft
ARG MINECRAFT_VERSION="1.20.1"
ARG PAPER_BUILD="latest" # "latest" o un número específico

# Establece el directorio de trabajo dentro del contenedor
WORKDIR /server

# Descarga PaperMC
# Puedes obtener el link de descarga desde https://papermc.io/downloads/paper
# Ejemplo para 1.20.1
RUN wget -O paper.jar https://api.papermc.io/v2/projects/paper/versions/${MINECRAFT_VERSION}/builds/${PAPER_BUILD}/downloads/paper-${MINECRAFT_VERSION}-${PAPER_BUILD}.jar

# Aceptar el EULA (End User License Agreement)
# ¡CRÍTICO! Necesario para que el servidor inicie.
RUN echo "eula=true" > eula.txt

# Copiar server.properties si lo tienes
COPY server.properties .

# Copiar la carpeta de plugins si existe
COPY plugins ./plugins

# Exponer el puerto por defecto de Minecraft
EXPOSE 25565

# Comando para iniciar el servidor Paper
# Ajusta la RAM máxima y mínima (-Xmx/-Xms) aquí.
CMD ["java", "-Xmx4G", "-Xms1G", "-jar", "paper.jar", "nogui"]